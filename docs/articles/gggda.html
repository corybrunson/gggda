<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualizing Multivariate Data in {ggplot2} • gggda</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualizing Multivariate Data in {ggplot2}">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gggda</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/gggda.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/corybrunson/gggda/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualizing Multivariate Data in {ggplot2}</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/corybrunson/gggda/blob/HEAD/vignettes/gggda.Rmd" class="external-link"><code>vignettes/gggda.Rmd</code></a></small>
      <div class="d-none name"><code>gggda.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The {gggda} package is a mostly standard-issue extension to <a href="https://github.com/tidyverse/ggplot2" class="external-link">{ggplot2}</a>: It consists
of <a href="https://ggplot2.tidyverse.org/reference/ggplot2-ggproto.html" class="external-link">ggprotos</a>
for a coordinate system (“coord”) and several statistical
transformations (“stat”), and geographic constructions (“geom”) that
almost exclusively use standard aesthetic mappings and recognizable
parameters and defaults.</p>
<p>The coords, stats, and geoms implement a variety of tools used in
multivariate data analysis. By design, tools implemented in other
{ggplot2} extensions are not reinvented here—or, at least, they’re not
meant to be! For example, <a href="https://github.com/jamesotto852/ggdensity" class="external-link">the {ggdensity}
package</a> provides plot layers for quantile-based density estimates
and contours, extending the native {ggplot2} layers for level-based
density visualizations, and users are encouraged to use it in tandem
with the {gggda}. As a result, though, those included in the package may
seem somewhat arbitrary. That said, the plot layers provided by {gggda}
implement methods that emerged from two distinct threads, which the
vignette will consider in turn.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/corybrunson/gggda" class="external-link">gggda</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A brief caution: Some code below uses the <code><a href="https://rdrr.io/r/base/sort_by.html" class="external-link">sort_by()</a></code>
function <a href="https://github.com/wch/r-source/blob/edd57ecc73890eac2a290dbeb04e54f9cbeac77f/doc/NEWS.Rd#L1151" class="external-link">introduced
in R version 4.4.0</a>; if that version is not yet installed, an
invisible code chunk is run that defines it from scratch.</p>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>To motivate and illustrate these tools, let’s investigate the
<code>USJudgeRatings</code> data set included with the basic
<code>R</code> installation. These data were obtained from the 1977
<em>New Haven Register</em> and contain several lawyers’ evaluations of
43 Superior Court<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Presumably this was the &lt;a href="https://www.jud.ct.gov/superiorcourt/" class="external-link"&gt;Connecticut Superior
Court&lt;/a&gt;.&lt;/p&gt;'><sup>1</sup></a> judges based, or so i infer (i have not
found a journal article citation or been able to access the newspaper
edition), on a number of interactions with them. The variables include
the (standardized) number of interactions, ratings of 10 criteria
ranging from judicial integrity to physical ability, and a final rating
of retention worthiness; the ratings all use a 10-point scale. Here are
those ratings for a sample of the judges:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">USJudgeRatings</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">USJudgeRatings</span><span class="op">)</span>, <span class="fl">6L</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;                CONT INTG DMNR DILG CFMG DECI PREP FAMI ORAL WRIT PHYS RTEN</span></span>
<span><span class="co">#&gt; MIGNONE,A.F.    6.6  7.4  6.2  6.2  5.4  5.7  5.8  5.9  5.2  5.8  4.7  5.2</span></span>
<span><span class="co">#&gt; DEVITA,H.J.     6.5  8.0  7.6  7.2  7.0  7.1  6.9  7.0  7.0  7.1  6.9  7.2</span></span>
<span><span class="co">#&gt; SPONZO,M.J.     6.9  8.3  8.0  8.1  7.9  7.9  7.9  7.7  7.6  7.7  8.1  8.0</span></span>
<span><span class="co">#&gt; STAPLETON,J.F.  6.5  8.2  7.7  7.8  7.6  7.7  7.7  7.7  7.5  7.6  8.5  7.7</span></span>
<span><span class="co">#&gt; SADEN.G.A.      6.6  7.4  6.9  8.4  8.0  7.9  8.2  8.4  7.7  7.9  8.4  7.5</span></span>
<span><span class="co">#&gt; BERDON,R.I.     6.8  8.8  8.5  8.8  8.3  8.5  8.7  8.7  8.4  8.5  8.8  8.7</span></span></code></pre></div>
<p>For convenience, we reformat the data with an additional column for
the name of the judge:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">USJudgeRatings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"NAME"</span><span class="op">)</span> <span class="op">-&gt;</span></span>
<span>  <span class="va">judge_ratings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">judge_ratings</span><span class="op">)</span></span>
<span><span class="co">#&gt;             NAME CONT INTG DMNR DILG CFMG DECI PREP FAMI ORAL WRIT PHYS RTEN</span></span>
<span><span class="co">#&gt; 1  AARONSON,L.H.  5.7  7.9  7.7  7.3  7.1  7.4  7.1  7.1  7.1  7.0  8.3  7.8</span></span>
<span><span class="co">#&gt; 2 ALEXANDER,J.M.  6.8  8.9  8.8  8.5  7.8  8.1  8.0  8.0  7.8  7.9  8.5  8.7</span></span>
<span><span class="co">#&gt; 3 ARMENTANO,A.J.  7.2  8.1  7.8  7.8  7.5  7.6  7.5  7.5  7.3  7.4  7.9  7.8</span></span>
<span><span class="co">#&gt; 4    BERDON,R.I.  6.8  8.8  8.5  8.8  8.3  8.5  8.7  8.7  8.4  8.5  8.8  8.7</span></span>
<span><span class="co">#&gt; 5   BRACKEN,J.J.  7.3  6.4  4.3  6.5  6.0  6.2  5.7  5.7  5.1  5.3  5.5  4.8</span></span>
<span><span class="co">#&gt; 6     BURNS,E.B.  6.2  8.8  8.7  8.5  7.9  8.0  8.1  8.0  8.0  8.0  8.6  8.6</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="multivariate-summaries">Multivariate summaries<a class="anchor" aria-label="anchor" href="#multivariate-summaries"></a>
</h2>
<p>The first set of methods is the extension of univariate summaries to
multivariate, and usually bivariate, data. For example, univariate data
have a natural ranking by value: Arrange the cases in order of a
variable value, and the rank of each case is its position in order:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_ratings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">NAME</span>, <span class="va">RTEN</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sort_by.html" class="external-link">sort_by</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="va">RTEN</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>RANK <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">judge_ratings</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;              NAME RTEN RANK</span></span>
<span><span class="co">#&gt; 30   RUBINOW,J.E.  9.2    1</span></span>
<span><span class="co">#&gt; 7   CALLAHAN,R.J.  9.0    2</span></span>
<span><span class="co">#&gt; 26     NARUK,H.J.  9.0    3</span></span>
<span><span class="co">#&gt; 9       DALY,J.J.  8.8    4</span></span>
<span><span class="co">#&gt; 34   SHEA,J.F.JR.  8.8    5</span></span>
<span><span class="co">#&gt; 2  ALEXANDER,J.M.  8.7    6</span></span></code></pre></div>
<p>There’s no obvious analog to this for bivariate data: Suppose we want
to rank judges by how well they maintain the legitimacy of their court.
This might implicate two ratings in the data in particular, their
integrity and the promptness of their decisions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">judge_ratings</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">INTG</span>, y <span class="op">=</span> <span class="va">DECI</span>, label <span class="op">=</span> <span class="va">NAME</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">judge_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">NAME</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="gggda_files/figure-html/text-1.png" width="672" style="display: block; margin: auto;"></p>
<p>While these ratings are correlated, several individual judges were
rated significantly more highly on one criterion than on the other, and
there is a clear “core” of judges who received average ratings on both.
In the next section we’ll see how these ratings might be combined into
an aggregate; for now, we’ll consider how to rank the judges not by the
values of their ratings but by their typicality or “averageness”: On
this score, middling judges should be ranked highly while outlying
judges should be ranked lowly. Such a measure might be useful for
identifying idiosyncratic judges for recruitment to consensus working
groups or even those whose rankings should be re-evaluated. Visually,
this property can be captured by sequentially “peeling” outer layers of
the point cloud and giving each layer the same rank. The most common way
to do this is probably via convex hulls:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, hjust <span class="op">=</span> <span class="st">"outward"</span>, vjust <span class="op">=</span> <span class="st">"outward"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/stat_chull.html">stat_peel</a></span><span class="op">(</span>num <span class="op">=</span> <span class="cn">Inf</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation: <span style="color: #00BB00;">label</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span><span class="co">#&gt;   the data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img src="gggda_files/figure-html/peel-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The plot identifies Judges Saden and Driscoll, for example, as
outliers, despite their average or just-below-average ratings on both
criteria. The more middling judges’ names are harder to read, but we can
extract the assignments directly to examine the most peripheral and core
hulls:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_ratings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">INTG</span>, <span class="va">DECI</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/peel_hulls.html">peel_hulls</a></span><span class="op">(</span>num <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">judge_ratings</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">judge_ratings</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"i"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">prop</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sort_by.html" class="external-link">sort_by</a></span><span class="op">(</span><span class="op">~</span> <span class="va">hull</span> <span class="op">+</span> <span class="va">NAME</span><span class="op">)</span> <span class="op">-&gt;</span></span>
<span>  <span class="va">judge_hulls</span></span>
<span><span class="va">judge_hulls</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>subset <span class="op">=</span> <span class="va">hull</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">hull</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    hull           NAME CONT INTG DMNR DILG CFMG DECI PREP FAMI ORAL WRIT PHYS</span></span>
<span><span class="co">#&gt; 8     1     COHEN,S.S.  7.0  5.9  4.9  5.1  5.4  5.9  4.8  5.1  4.7  4.9  6.8</span></span>
<span><span class="co">#&gt; 13    1  DRISCOLL,P.J.  6.7  8.6  8.2  6.8  6.9  6.6  7.1  7.3  7.2  7.2  8.1</span></span>
<span><span class="co">#&gt; 23    1   MIGNONE,A.F.  6.6  7.4  6.2  6.2  5.4  5.7  5.8  5.9  5.2  5.8  4.7</span></span>
<span><span class="co">#&gt; 26    1     NARUK,H.J.  7.8  8.9  8.7  8.9  8.7  8.8  8.9  9.0  8.8  8.9  9.0</span></span>
<span><span class="co">#&gt; 30    1   RUBINOW,J.E.  7.1  9.2  9.0  9.0  8.4  8.6  9.1  9.1  8.9  9.0  8.9</span></span>
<span><span class="co">#&gt; 31    1     SADEN.G.A.  6.6  7.4  6.9  8.4  8.0  7.9  8.2  8.4  7.7  7.9  8.4</span></span>
<span><span class="co">#&gt; 1     7  AARONSON,L.H.  5.7  7.9  7.7  7.3  7.1  7.4  7.1  7.1  7.1  7.0  8.3</span></span>
<span><span class="co">#&gt; 3     7 ARMENTANO,A.J.  7.2  8.1  7.8  7.8  7.5  7.6  7.5  7.5  7.3  7.4  7.9</span></span>
<span><span class="co">#&gt; 38    7 STAPLETON,J.F.  6.5  8.2  7.7  7.8  7.6  7.7  7.7  7.7  7.5  7.6  8.5</span></span>
<span><span class="co">#&gt;    RTEN</span></span>
<span><span class="co">#&gt; 8   5.0</span></span>
<span><span class="co">#&gt; 13  7.7</span></span>
<span><span class="co">#&gt; 23  5.2</span></span>
<span><span class="co">#&gt; 26  9.0</span></span>
<span><span class="co">#&gt; 30  9.2</span></span>
<span><span class="co">#&gt; 31  7.5</span></span>
<span><span class="co">#&gt; 1   7.8</span></span>
<span><span class="co">#&gt; 3   7.8</span></span>
<span><span class="co">#&gt; 38  7.7</span></span></code></pre></div>
<p>Judges Aaronson, Armentano, and Stapleton constitute the innermost
hull, and again the density of the core makes it difficult to build
intuition about this stratification. We can, for example, check whether
peripherality with respect to the nested hulls is systematically related
to overall retention rating:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_hulls</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>hull <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">hull</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">hull</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hull</span>, y <span class="op">=</span> <span class="va">RTEN</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="gggda_files/figure-html/order-1.png" width="672" style="display: block; margin: auto;"></p>
<p>While the fewer data in each hull yield narrower boxplots, there is
no evident upward or downward trend. But peeling data from the outside
inward is not the only way to stratify by centrality. Another approach
is is called <em>data depth</em>, based on a family of notions of
<em>global</em> depth that are distinct from <em>local</em> notions of
density. One of the most famous deployments of data depth is the
“bag-and-bolster plot” comprising a “bag” delineated by a depth contour
and a “fence” by expanding the bag outward from the depth median. As
with a box-and-whisker plot, markers outside the fence identify
outliers. In the bag-and-bolster plot below, we used trial and error to
customize the fraction contained in the bag and the scale factor of the
fence, add text labels to the judges of the outermost and innermost
hulls:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/stat_bagplot.html">stat_bagplot</a></span><span class="op">(</span>fraction <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, coef <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">judge_hulls</span>, <span class="va">hull</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">hull</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span>, hjust <span class="op">=</span> <span class="st">"outward"</span>, vjust <span class="op">=</span> <span class="st">"outward"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation: <span style="color: #00BB00;">label</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span><span class="co">#&gt;   the data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img src="gggda_files/figure-html/bag-1.png" width="672" style="display: block; margin: auto;"></p>
<p>For these data, the two stratifications are broadly consistent.
However, the data seem to have a greater skew toward lower values on the
periphery than in the core, resulting in Judges Naruk and Rubinow lying
well within the fence while Judges Cohen and Mignone lie near its
boundary, despite all four belonging to the outermost hull.</p>
</div>
<div class="section level2">
<h2 id="ordination-and-biplots">Ordination and biplots<a class="anchor" aria-label="anchor" href="#ordination-and-biplots"></a>
</h2>
<p>The second set of methods enables analysis of many variables at once.
These <em>ordination</em> models typically use linear algebra to obtain
a sequence of artificial coordinates, each of which captures the most
desired behavior after adjusting for the previous. In the most popular
ordination model, principal components analysis, the principal
components (PCs) account for the maximum amount of inertia, or
multidimensional variance in each successive residual subspace.</p>
<p>PCA is often applied to heterogeneous data, which requires that the
variables be rescaled to have common variance. In this case, however,
each criterion is rated on the same scale, so the simplifying assumption
that their distributions (specifically their variances) are equivalent
in the population is plausible.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_ratings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">NAME</span>, <span class="va">CONT</span>, <span class="va">RTEN</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></span><span class="op">(</span>cor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-&gt;</span></span>
<span>  <span class="va">judge_pca</span></span></code></pre></div>
<p>As a technique for dimension reduction, PCA works best when the
variables are highly dependent—not necessarily pairwise correlated, but
such that the low-dimensional subspace coordinatized by the first few
PCs contains a large share of the inertia. The componentwise variance
and cumulative inertia are reported in the summary. We also examine the
variable loadings onto the PCs, which allow us to interpret the PCs as
latent variables (as in factor analysis, though the theoretical
justification is weaker and their meanings are less
straightforward).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">judge_pca</span><span class="op">)</span></span>
<span><span class="co">#&gt; Importance of components:</span></span>
<span><span class="co">#&gt;                           Comp.1     Comp.2     Comp.3      Comp.4      Comp.5</span></span>
<span><span class="co">#&gt; Standard deviation     2.7951637 0.60340001 0.46035803 0.272421916 0.170365235</span></span>
<span><span class="co">#&gt; Proportion of Variance 0.9158885 0.04268141 0.02484389 0.008699859 0.003402437</span></span>
<span><span class="co">#&gt; Cumulative Proportion  0.9158885 0.95856994 0.98341383 0.992113689 0.995516126</span></span>
<span><span class="co">#&gt;                             Comp.6      Comp.7       Comp.8       Comp.9</span></span>
<span><span class="co">#&gt; Standard deviation     0.121735488 0.111429240 0.0726587640 0.0616838629</span></span>
<span><span class="co">#&gt; Proportion of Variance 0.001737251 0.001455548 0.0006188767 0.0004460374</span></span>
<span><span class="co">#&gt; Cumulative Proportion  0.997253377 0.998708925 0.9993278015 0.9997738389</span></span>
<span><span class="co">#&gt;                             Comp.10</span></span>
<span><span class="co">#&gt; Standard deviation     0.0439232932</span></span>
<span><span class="co">#&gt; Proportion of Variance 0.0002261611</span></span>
<span><span class="co">#&gt; Cumulative Proportion  1.0000000000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">judge_pca</span><span class="op">$</span><span class="va">loadings</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loadings:</span></span>
<span><span class="co">#&gt;      Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9 Comp.10</span></span>
<span><span class="co">#&gt; INTG  0.250  0.447  0.135         0.464  0.650  0.157  0.236               </span></span>
<span><span class="co">#&gt; DMNR  0.370  0.727 -0.171  0.214 -0.295 -0.385               -0.132        </span></span>
<span><span class="co">#&gt; DILG  0.308 -0.156  0.301  0.335  0.590 -0.393  0.145 -0.379               </span></span>
<span><span class="co">#&gt; CFMG  0.292 -0.277         0.509 -0.155  0.342 -0.614        -0.241        </span></span>
<span><span class="co">#&gt; DECI  0.272 -0.281         0.387 -0.391  0.115  0.685  0.201  0.144        </span></span>
<span><span class="co">#&gt; PREP  0.332 -0.152  0.220 -0.146        -0.328 -0.252  0.638  0.312  0.336 </span></span>
<span><span class="co">#&gt; FAMI  0.328 -0.159  0.224 -0.491                       0.160 -0.511 -0.525 </span></span>
<span><span class="co">#&gt; ORAL  0.356               -0.234 -0.135  0.133 -0.163 -0.371  0.701 -0.355 </span></span>
<span><span class="co">#&gt; WRIT  0.337         0.152 -0.306 -0.221  0.137        -0.433 -0.206  0.683 </span></span>
<span><span class="co">#&gt; PHYS  0.296 -0.209 -0.860 -0.149  0.297                                    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9</span></span>
<span><span class="co">#&gt; SS loadings       1.0    1.0    1.0    1.0    1.0    1.0    1.0    1.0    1.0</span></span>
<span><span class="co">#&gt; Proportion Var    0.1    0.1    0.1    0.1    0.1    0.1    0.1    0.1    0.1</span></span>
<span><span class="co">#&gt; Cumulative Var    0.1    0.2    0.3    0.4    0.5    0.6    0.7    0.8    0.9</span></span>
<span><span class="co">#&gt;                Comp.10</span></span>
<span><span class="co">#&gt; SS loadings        1.0</span></span>
<span><span class="co">#&gt; Proportion Var     0.1</span></span>
<span><span class="co">#&gt; Cumulative Var     1.0</span></span></code></pre></div>
<p>The PCA summary shows that the vast majority of the variance (92%)
already lies in a single dimension, along the first PC, and that roughly
half of the remainder (4%) lies along the second; 96% lies within the
plane of the first two PCs and would therefore be visualized in a plot
using them as axes. The loadings suggest that some of the ratings
(diligence, soundness of oral and written rulings) align more closely
with PC1 and some (integrity and demeanor) with PC2, while others
(management of case flow, promptness of decisions, physical ability) are
similarly aligned with both.</p>
<p>These insights can be efficiently visualized by plotting the cases
(judges) and for the variables (criteria) on the plane defined by the
first two PCs. The quality of the resulting <em>biplot</em> depends on
the proportion of variance along those PCs. In the biplot below, the
cases are represented by circular markers and the variables by arrows,
using a geometric construction provided by {gggda}. The aspect ratio is
fixed at 1 to avoid misrepresenting the inertia.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Comp.1</span>, y <span class="op">=</span> <span class="va">Comp.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">judge_pca</span><span class="op">$</span><span class="va">scores</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_vector.html">geom_vector</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="va">judge_pca</span><span class="op">$</span><span class="va">loadings</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#007a3d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="gggda_files/figure-html/vector-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The plot makes clear the singular importance of PC1: Indeed, all
rating scales load positively onto it, so it could be interpreted as a
dimension of overall quality. It is also clear that most of the criteria
are tightly correlated into two roughly orthogonal groups, though these
groups don’t line up perfectly with the two PCs. (A rotation might be
applied that would improve the “simple structure” of the PCA, but that
is beyond the scope of this introduction.) However, the plot is limited
in several ways: We can’t tell which marker represents which judge or
which arrow represents which criterion, and the quiver of arrows is
quite small due to the different scales of the cases and the
variables.</p>
<p>In the code chunk below, we pre-process the scores and loadings into
data frames with additional variables and use these variables to improve
the annotations. (Notice our clever double-use of <code>NAME</code> for
cases and variables, which allows us to distribute the aesthetic
<code>label = NAME</code> across both layers.) We also remove gridlines
from the theme since the PCs are not themselves meaningful, and we use a
new coordinate system that expands the plotting window to a square while
holding the aspect ratio fixed. Finally, we rescale the variables to be
distinguishable at the same scale as the cases and add additional axis
legends for this new scale.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;While we don’t illustrate it here, knowing the
artificial coordinates of elements on both layers of a biplot allows the
original data elements to be recovered via inner product.)&lt;/p&gt;"><sup>2</sup></a></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_pca</span><span class="op">$</span><span class="va">scores</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>NAME <span class="op">=</span> <span class="va">judge_ratings</span><span class="op">$</span><span class="va">NAME</span><span class="op">)</span> <span class="op">-&gt;</span></span>
<span>  <span class="va">judge_scores</span></span>
<span><span class="va">judge_pca</span><span class="op">$</span><span class="va">loadings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"NAME"</span><span class="op">)</span> <span class="op">-&gt;</span></span>
<span>  <span class="va">judge_loadings</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Comp.1</span>, y <span class="op">=</span> <span class="va">Comp.2</span>, label <span class="op">=</span> <span class="va">NAME</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">judge_scores</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_vector.html">geom_vector</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">judge_loadings</span>, color <span class="op">=</span> <span class="st">"#007a3d"</span>,</span>
<span>              stat <span class="op">=</span> <span class="st">"scale"</span>, mult <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/coord_rect.html">coord_square</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">sec_axis</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.</span> <span class="op">/</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">sec_axis</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.</span> <span class="op">/</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="gggda_files/figure-html/square-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The arrows communicate the directions and magnitudes of each rating’s
associations with the two PCs. For example, the contribution of demeanor
to separating judges like Saden on one side of the overall quality axis
(PC1) and Driscoll on the other is at least half again that of
integrity. However, this information is impressionistic, and the plot
reveals little else. An alternative geometric construction allows for
easier interpretation: calibrated axes—basically, lines containing the
vectors with tick marks at regular multiples of them.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;These axes are interpolative; the position of a case
marker is the vector sum of its ratings. More useful in most
applications are predictive axes, but these require additional
calibration not yet available in {gggda}. See &lt;a href="https://cran.r-project.org/package=calibrate" class="external-link"&gt;the {calibrate}
package&lt;/a&gt; for possibly the most common solution in R.&lt;/p&gt;'><sup>3</sup></a></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Comp.1</span>, y <span class="op">=</span> <span class="va">Comp.2</span>, label <span class="op">=</span> <span class="va">NAME</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_axis.html">geom_axis</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">judge_loadings</span>, color <span class="op">=</span> <span class="st">"#007a3d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">judge_scores</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/coord_rect.html">coord_square</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="gggda_files/figure-html/axis-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Axes obviate the need for rescaling and provide more space to compare
the variables’ contributions. We can now see from the plot that every
rating other than demenear and integrity contributes similarly to the
spread, in terms of strength as well as of direction. Yet within this
similarity there are clusters: Soundness of oral and of written rulings
are closely aligned, as are management of case flow and promptness of
decisions, while diligence, legal familiarity, and trial preparation are
essentially indistinguishable.</p>
<p>Axes also provide a natural way to interpolate additional variables
onto an existing biplot, much as additional cases can be: We omitted
worthiness of retention ratings from this analysis because it was less
objective a criterion, but we can regress its values on the first two
PCs to get a sense of how it relates to the picture they paint:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_ratings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="va">RTEN</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">judge_scores</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">RTEN</span> <span class="op">~</span> <span class="va">Comp.1</span> <span class="op">+</span> <span class="va">Comp.2</span><span class="op">)</span> <span class="op">-&gt;</span></span>
<span>  <span class="va">judge_lm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">judge_lm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = RTEN ~ Comp.1 + Comp.2, data = cbind(subset(judge_ratings, </span></span>
<span><span class="co">#&gt;     select = RTEN), judge_scores))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.51408 -0.08375 -0.01568  0.09951  0.35963 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 7.602326   0.024394 311.652  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; Comp.1      0.383507   0.008727  43.944  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; Comp.2      0.174093   0.040427   4.306 0.000105 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.16 on 40 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9799, Adjusted R-squared:  0.9789 </span></span>
<span><span class="co">#&gt; F-statistic: 974.8 on 2 and 40 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Retention worthiness depends importantly on both PCs, though more
strongly on the first, indicating that it is more closely related to the
first “overall quality” dimension than to the second associated more
with demeanor and integrity—though both associations are positive. We
superimpose a ruler for this effect on the biplot and offset it from the
point cloud using the <code>referent</code> parameter, which accepts
data in the same format as <code>data</code> and pre-processes it in the
same way:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_lm</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>NAME <span class="op">=</span> <span class="st">"RTEN"</span><span class="op">)</span> <span class="op">-&gt;</span></span>
<span>  <span class="va">judge_coef</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Comp.1</span>, y <span class="op">=</span> <span class="va">Comp.2</span>, label <span class="op">=</span> <span class="va">NAME</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_axis.html">geom_axis</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">judge_loadings</span>, color <span class="op">=</span> <span class="st">"#007a3d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">judge_scores</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/stat_rule.html">stat_rule</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">judge_coef</span>, referent <span class="op">=</span> <span class="va">judge_scores</span>, color <span class="op">=</span> <span class="st">"#ce1126"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/coord_rect.html">coord_square</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="gggda_files/figure-html/rule-1.png" width="672" style="display: block; margin: auto;"></p>
<p>It is perhaps surprising that demeanor and integrity exert such a
significant (counterclockwise) pull on retention worthiness in relation
to the first PC, given the larger number of criteria whose ratings tug
in the opposite direction. This has the effect of positioning Judge
Driscoll similarly to Judge Saden, despite Saden’s higher rating on
every other criterion.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;We can confidently infer these inequalities from the
biplot only because it accounts for the vast majority of the variance in
the data, i.e. it is very high quality.&lt;/p&gt;"><sup>4</sup></a> Indeed, Judge Driscoll was rated slightly
more retention-worthy:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_ratings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"SADEN|DRISCOLL"</span>, <span class="va">NAME</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             NAME CONT INTG DMNR DILG CFMG DECI PREP FAMI ORAL WRIT PHYS RTEN</span></span>
<span><span class="co">#&gt; 13 DRISCOLL,P.J.  6.7  8.6  8.2  6.8  6.9  6.6  7.1  7.3  7.2  7.2  8.1  7.7</span></span>
<span><span class="co">#&gt; 31    SADEN.G.A.  6.6  7.4  6.9  8.4  8.0  7.9  8.2  8.4  7.7  7.9  8.4  7.5</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="outroduction">Outroduction<a class="anchor" aria-label="anchor" href="#outroduction"></a>
</h2>
<p>In closing, a few elements of practice are worth making explicit:
First, multivariate data visualization is a component of multivariate
data analysis, not a standalone option for it. Visualizations can elicit
patterns but are no substitute for rigorously confirming them. Second,
data may be multivariate in different ways that call for different
analytic and graphical approaches. Other multivariate data may involve
incommensurate variables unsuited for unscaled PCA, for example.</p>
<p>Finally, multivariate graphics are highly versatile. This is a
feature from the perspective of communication but has a double-edge with
respect to the design of an analysis toward a specific task (question,
hypothesis, objective): At the outset, the analyst must choose (not to
say pre-register, but not <em>not</em> to say that) settings that are
appropriate to the data and the task, and as the analysis progresses
they must balance an adaptability to revealed patterns with a rigor
toward the theory behind the task and the original analysis plan. The
larger {ggplot2} extension family provides several additional tools for
multivariate data visualization to both facilitate and complicate your
efforts.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason Cory Brunson, John Gracey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
